---
- # ====== Application Computation: AI_CONTRY_AREA =============
  id: 8123957799339288
  identification: 
    item-name: AI_CONTRY_AREA

  execution: 
    sequence: 10
    point: AFTER_LOGIN

  computation: 
    type: Function Body
    language: PL/SQL
    pl/sql-function-body: |
      DECLARE
          l_response CLOB;
          l_country  VARCHAR2(2);
      BEGIN
          -- Make the HTTP GET request
          l_response := APEX_WEB_SERVICE.MAKE_REST_REQUEST(
                          p_url         => 'https://ipinfo.io/json',
                          p_http_method => 'GET'
                        );
      
      
          l_country := REGEXP_SUBSTR(l_response, '"country"\s*:\s*"([A-Z]{2})"', 1, 1, NULL, 1);
      
          RETURN(GET_COUNTRY_CODE(l_country));
      EXCEPTION
          WHEN OTHERS THEN
              RETURN(NULL);
      END;

  subscription: 
    version-number: 41727859483881

